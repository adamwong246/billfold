<head>
  <title>billFold</title>
</head>

<body>
  <h1> BillFold </h1>
  <div id="outer">
    {{> grid }}
  </div>
</body>

<template name="grid">
  {{> loginButtons}}

  <h4> Add a new Bill </h4>
  <form class="new_bill">
    <input type="text" name="name" placeholder="bill name" />
    <br>
    <input type="number" name="amount" placeholder="amount" step="any" />
    <br>
    <label for="arrival_date">Arrival date</label>
    <input type="date" name="arrival_date" />
    <br>
    <label for="departure_date">Departure date</label>
    <input type="date" name="departure_date" />
    <br>
    <select name="owner" >
      {{#each users}}
        <option value="{{_id}}">{{identify_user _id}}</option>
      {{/each}}
    </select>
    <br>
    <input type="submit" value="New Bill">
  </form>

  <h4> Add a new UserBill </h4>
  <form class="new_user_bill">

    <select name="user" >
      {{#each users}}
        <option value="{{_id}}">{{identify_user _id}}</option>
      {{/each}}
    </select>
    <br>
    <select name="bill" >
      {{#each bills}}
        <option value="{{_id}}">{{name}}</option>
      {{/each}}
    </select>

    <br>
    <label for="arrival_date">Arrival date</label>
    <input type="date" name="arrival_date"/>
    <br>
    <label for="departure_date">Departure date</label>
    <input type="date" name="departure_date"/>
    <br>
    <input type="submit" value="New user bill">
  </form>

  <h4> Add a new payment </h4>
  <form class="new_payment">
    payer:
    <select name="payer" >
      {{#each users}}
        <option value="{{_id}}">{{identify_user this}}</option>
      {{/each}}
    </select>
    <br>
    payee:
    <select name="payee" >
      {{#each users}}
        <option value="{{_id}}">{{identify_user this}}</option>
      {{/each}}
    </select>
    <br>
    <input type="number" name="amount" placeholder="amount" step="any" />
    <br>
    <input type="submit" value="New Payment">
  </form>

  <h4> users </h4>
  <ol>
    {{#each users}}
      <li>
        {{> user}}
      </li>
    {{/each}}
  </ol>

  <h4> bills </h4>
  <ol>
    {{#each bills}}
      <li>
        {{> bill}}
      </li>
    {{/each}}
  </ol>

  <h4> user bills </h4>
  <ol>
    {{#each user_bills}}
      <li>
        {{> user_bill}}
      </li>
    {{/each}}
  </ol>

  <h4> payments </h4>
  <ol>
    {{#each payments}}
      <li>
        {{> payment}}
      </li>
    {{/each}}
  </ol>

</template>

<template name="user">
  <div class="user">
    {{identify_user this}}
  </div>
</template>

<template name="bill">
  <div class="bill">
    {{name}}, ${{amount}}, {{prettifyDate arrival_date}} --- {{prettifyDate departure_date}}
    <input type="button" class="delete_bill" value="delete" data-billid={{_id}} />
  </div>
</template>

<template name="payment">
  <div class="payment">
    From: {{identify_user payer}}, To: {{identify_user payee}}, ${{amount}}
    <input type="button" class="delete_payment" value="delete" data-paymentid={{_id}} />
  </div>
</template>

<template name="user_bill">
  <div class="user_bill">
    {{identify_user user}}
    {{identify_bill bill}}
    {{prettifyDate arrival_date}} --- {{prettifyDate departure_date}}
    ${{owed}}
    <input type="button" class="delete_user_bill" value="delete" data-userbillid={{_id}} />
  </div>
</template>